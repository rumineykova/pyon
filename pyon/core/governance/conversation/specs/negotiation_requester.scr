protocol Negotiation at requester(role provider, role requester, role adviser)
{
    propose(string) to provider;
    (string) from provider;
    consult(string) to adviser;
    (string) from adviser;
    @{guard: repeat=0}
    rec Start{
        choice at requester {
            accept(string) to provider;
            () from provider;
            accept(string) to adviser;
            () from adviser;
        } or {
            reject(string) to provider;
            () from provider;
            reject(string) to adviser;
            () from adviser;
       } or {
            @{guard: repeat<4}
            propose(string) to provider;
            (string) from provider;
            consult(string) to adviser;
            (string) from adviser;
            Start;}
    }
}
